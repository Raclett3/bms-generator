# bms-generator (BMS自動生成くん)

```
BMSを
  自動で
    作るのだ！
```

## 説明

DJゆかり (sinri氏) が開発した地力向上プログラムの改良を目指すプロジェクト

(TODO: ニコニコ動画のサービス停止中のため、動画をあとで貼る)

## 動作環境

- Rust

- Cargo

## つかいかた

1. `keysound-gen` でキー音を生成する

    ```
    $ cargo run --bin keysound-gen -- path/to/bms/folder
    ```

2. `bms-generator` で、キー音と同一のディレクトリに譜面を生成する

    ```
    cargo run --bin bms-generator-cli -- path/to/bms/folder/chart.bms
    ```

3. 🎉 Party Time!!! 🕺

## CLI のつかいかた

`--help` オプションでも確認できるよ

```
bms-generator-cli [OPTIONS] <FILENAME>
```

`<FILENAME>`: 出力 BMS のファイル名

### オプション

- `--bpm`: BPM (デフォルトは150)

- `--bars`: 小節数 (デフォルトは16)

- `--seed`: 乱数のシード (省略した場合は現在時刻をシードとして使用)

- `--density`: 譜面の密度を指定 (コンマ区切りで `1分,2分,4分,8分,16分` の順にパーセンテージで指定)

    例えばデフォルト値である `0,0,100,100,100` の場合、同時に押す個数は 3個 → 1個 → 2個 → 1個 のパターンの繰り返しとなる

    指定された値が 100 の倍数でなかった場合、例えば `140` の場合では、 40% の確率で 2個、残りの 60% の確率で 1個 となる

- `--jack-tolerance`: 縦連の許容度を指定

    許容度の整数部分と小数部分をそれぞれ a, b としたとき、連続した a+1 個までのノーツは確実に許可し、連続する a+2 個のノーツは b の確率で許可(それ以外は再抽選)

- `--scatter`: 譜面の散らばりの強度

    大きな値を設定するほど、直近でノーツが降ってきたレーンにノーツが降ってきにくく(軸や縦連やトリルが少なく)なる

    負の値を設定すると、同じレーンにノーツが連続で降ってきやすくなる

    (極端に大きな値(100以上)を設定すると、繰り返しパターンが降ってきやすくなる)

- `--scatter-decay-rate`: `--scatter` で参照するノーツの範囲 (0.0 から 1.0)

    大きな値を設定すると譜面全体を参照し、小さな値を設定するとより狭い範囲を参照する

## 実装済み / 実装予定の機能

- [x] 最低限の BMS 生成機能

- [x] 縦連の許容度設定

- [x] 軸の補正機能

- [ ] もっとリッチなキー音

- [ ] 好きなメロディをキー音にする機能

- [ ] GUI (Web UI 予定)
